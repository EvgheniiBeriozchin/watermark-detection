# Watermark Detection
This is a project which aims to improve the comparison and detection of historical paper watermarks.
It was completed as part of the TUM Data Innovation Lab in partnership with the TU Delft and the German National Library and Museum of Books and Writing.

Full Report is available here: https://www.mdsi.tum.de/fileadmin/w00cet/di-lab/pdf/TUM_Chair_for_Geometry_and_Visualization___TUM-DI-LAB_FinalReport_SS2023-1.pdf
# Description
The study of watermarks holds significant importance for historical humanities. Watermarks offer valuable insights into the origins and production of paper, aiding in identifying papermakers, mills, and periods when a specific piece of paper was made. This information plays a crucial role in dating and verifying historical documents. By identifying watermarks in various documents, one can establish connections between manuscripts, trace paper sources, and track trade routes and distribution networks. However, the identification of such watermarks and comparison is currently a time-consuming manual process. 
 
This report presents a novel approach to automatically finding similar watermarks within the database of the German Museum of Books and Writing and the German National Library (DNB) based on their digitized collection of historical papers, watermarks, and traced watermarks.  
As the DNB continuously adds new watermarks to the database, we aimed for an approach independent of the current digitization status and adaptive to new watermarks. Furthermore, as the watermarks are loosely labeled, the network needed to be independent of input-output pairs.
In our approach, we use the image dataset provided by the DNB to create an unpaired dataset of watermarks and watermark sketches. The latter are generated by preprocessing watermark tracings. Using this dataset, we first preprocess the watermarks using different image processing techniques and then we train a CycleGAN neural network that can generate a sketch of a watermark present in a scan of a historical paper. With this model we generate sketches for all watermarks from the dataset and combine them with the sketches produced by preprocessing tracings. As a next step, we use a pre-trained ResNet18 neural network to extract a feature vector for each sketch. Finally, we use the Spotify Annoy algorithm, which enables an efficient approximate nearest neighbor search to compare a  generated  sketch for a new watermark with our entire database.  
As a result, our full pipeline allows the user to input a watermark or a tracing thereof and get similar watermarks from the existing database. Within 25 nearest neighbors, we achieve an accuracy of more then 50%, and within 50 nearest neighbors, we achieve an accuracy of over 68% when comparing a new watermark to a database of over 6600 digitized watermarks and traced watermarks. The database can then be easily connected to the metadata provided by the DNB to get more information about each watermark. 

## Links
 - https://www.memoryofpaper.eu/BernsteinPortal/appl_start.disp
 - https://www.dnb.de/DE/Professionell/Metadatendienste/Datenbezug/SRU/sru_node.html;jsessionid=CCD1FA43A4A2B50A6B5D346DB11D4846.intranet251
 - https://www.dnb.de/DE/Professionell/Metadatendienste/metadatendienste_node.html
